-- 1 --
SELECT EMPLOYEES.FIRST_NAME, EMPLOYEES.LAST_NAME, DEPARTMENTS.DEPARTMENT_NAME
FROM EMPLOYEES, DEPARTMENTS
WHERE EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID AND
PHONE_NUMBER LIKE '625%' ORDER BY EMPLOYEES.FIRST_NAME, EMPLOYEES.LAST_NAME;

-- 2 --
SELECT EMPLOYEES.JOB_ID, COUNT(*)
FROM EMPLOYEES
GROUP BY EMPLOYEES.JOB_ID
ORDER BY EMPLOYEES.JOB_ID DESC;

-- 3 --
SELECT EMPLOYEES.DEPARTMENT_ID AS "CÃ³digo departamento", count(*)
FROM EMPLOYEES
GROUP BY EMPLOYEES.DEPARTMENT_ID
HAVING COUNT(*) > 10;

-- 4 --
SELECT EMPLOYEES.LAST_NAME, EMPLOYEES.FIRST_NAME, EMPLOYEES.SALARY
FROM EMPLOYEES
WHERE EMPLOYEES.DEPARTMENT_ID IN
(SELECT MAX(EMPLOYEES.SALARY), DEPARTMENT_ID
FROM EMPLOYEES
GROUP BY EMPLOYEES.DEPARTMENT_ID)

-- 5 --

SELECT E2.MANAGER_ID, E2.FIRST_NAME, COUNT(*)
FROM EMPLOYEES E1, EMPLOYEES E2
WHERE E1.EMPLOYEE_ID = E2.MANAGER_ID
GROUP BY E2.MANAGER_ID, E2.FIRST_NAME;

-- 6 --

SELECT EMPLOYEES.FIRST_NAME
FROM EMPLOYEES
WHERE (EMPLOYEES.SALARY + (EMPLOYEES.SALARY * EMPLOYEES.COMMISSION_PCT)) >
(SELECT AVG(EMPLOYEES.SALARY)
FROM EMPLOYEES);

-- 7 --

SELECT DEPARTMENT_ID,FIRST_NAME,LAST_NAME,SALARY
FROM EMPLOYEES
WHERE SALARY =
(SELECT EMPLOYEES.DEPARTMENT_ID, MAX(SALARY)
FROM EMPLOYEES
GROUP BY EMPLOYEES.DEPARTMENT_ID;

-- 8 --
UPDATE EMPLOYEES.EMPLOYEES
SET EMPLOYEES.SALARY = EMPLOYEES.SALARY * 1.10
WHERE EMPLOYEES.SALARY <
(SELECT AVG(EMPLOYEES.SALARY)
FROM EMPLOYEES);

-- 9 --
SELECT EMPLOYEES.FIRST_NAME, EMPLOYEES.JOB_ID
FROM EMPLOYEES
GROUP BY EMPLOYEES.FIRST_NAME, EMPLOYEES.JOB_ID
HAVING COUNT(*) =
(SELECT COUNT(JOB_ID)
FROM JOBS);

-- 10 --
DELETE FROM EMPLOYEES
WHERE DEPARTMENT_ID =
(SELECT EMPLOYEES.DEPARTMENT_ID
FROM EMPLOYEES, DEPARTMENTS, LOCATIONS
WHERE EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID
AND DEPARTMENTS.LOCATION_ID = LOCATIONS.LOCATION_ID
AND LOCATIONS.CITY LIKE 'LONDRES');
